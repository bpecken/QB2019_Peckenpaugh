library(vegan)
install.packages("vegan")
library(vegan)
data(BCI)
simp <- diversity(BCI[1,], "simp")
D <- diversity(BCI[1,], "simp")
D1 <- 1 - D
invD <- 1/D
print(D, D1, invD)
print(D)
print(D)
print(D1)
print(invD)
hist(BCI[1,])
BCI[1,]
str(BCI)
hist(as.numeric(BCI[1,]))
hist(as.numeric(BCI[1,]), xlab = "Species abundance")
hist(as.numeric(BCI[1,]), xlab = "Species abundance", main="")
hist(as.numeric(BCI[1,]), xlab = "Species abundance at site 1", main="")
bird <- read.table("~/Downloads/hf085-01-bird.csv")
head(bird)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",")
head(bird)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
head(bird)
str(bird)
bird <- as.numeric(bird)
bird <- apply(bird, 2, as.numeric())
bird <- apply(bird, 2, as.numeric)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
bird <- apply(bird, 1, as.numeric)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
bird <- apply(bird, 2, as.numeric)
bird
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
bird <- apply(bird[,c(2:ncols(bird))], 2, as.numeric)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
bird <- apply(bird[,c(2:numcols(bird))], 2, as.numeric)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
bird <- apply(bird[,c(2:ncol(bird))], 2, as.numeric)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
bird <- apply(bird[,c(3:ncol(bird))], 2, as.numeric)
head(bird)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
head(bird)
str(bird)
bird <- read.table("~/Downloads/hf085-01-bird.csv", sep =",", header=T)
bird[,c(3:ncol(bird))] <- apply(bird[,c(3:ncol(bird))], 1, as.numeric)
head(bird)
str(bird)
dim(bird)
hist(as.numeric(bird[1,]), xlab = "Species abundance at site 1", main="")
hist(as.numeric(bird[2,]), xlab = "Species abundance at site 1", main="")
hist(as.numeric(bird[3,]), xlab = "Species abundance at site 1", main="")
bird[3,]
hist(as.numeric(bird[3,c(3:ncol(bird))]), xlab = "Species abundance at site 1", main="")
hist(bird[3,c(3:ncol(bird))], xlab = "Species abundance at site 1", main="")
hist(as.numeric(bird[3,c(3:ncol(bird))]), xlab = "Species abundance at site 1", main="")
hist(as.numeric(BCI[1,]), xlab = "Species abundance at site 1", main="")
S.obs <- function(x = ""){
rowSums(x > 0) * 1
}
S.obs(BCI[1, ])
specnumber(BCI[1, ])
specnumber(BCI[2, ])
specnumber(BCI[3, ])
specnumber(BCI[4, ])
C <- function(x = ""){
1 - (rowSums(x == 1) / rowSums(x))
}
C(BCI)
soilbac <- read.table("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
soilbac.t <- as.data.frame(t(soilbac))
soilbac1 <- soilbac.t[1,]
S.obs(soilbac1)
rowSums(soilbac1)
C(soilbac1)
S.chao1 <- function(x = ""){
S.obs(x) + (sum(x == 1)^2) / (2 * sum(x == 2))
}
S.chao2 <- function(site = "", SbyS = ""){
SbyS = as.data.frame(SbyS)
x = SbyS[site, ]
SbyS.pa <- (SbyS > 0) * 1
Q1 = sum(colSums(SbyS.pa) == 1)
Q2 = sum(colSums(SbyS.pa) == 2)
S.chao2 = S.obs(x) + (Q1^2)/(2*Q2)
return(S.chao2)
}
S.ace <- function(x = "", thresh = 10){
x <- x[x>0]
S.abund <- length(which(x > thresh))
S.rare <- length(which(x <= thresh))
singlt <- length(which(x == 1))
N.rare <- sum(x[which(x <= thresh)])
C.ace <- 1 - (singlt / N.rare)
i <- c(1:thresh)
count <- function(i, y){
length(y[y == i])
}
a.1 <- sapply(i, count, x)
f.1 <- (i * (i - 1)) * a.1
G.ace <- (S.rare/C.ace)*(sum(f.1)/(N.rare*(N.rare-1)))
S.ace <- S.abund + (S.rare/C.ace) + (singlt/C.ace) * max(G.ace,0)
return(S.ace)
}
S.chao1(soilbac1)
S.chao2(soilbac1)
S.chao2(soilbac)
S.chao2(soilbac.t)
S.chao2(1, soilbac.t)
S.chao1(soilbac1)
S.ace(soilbac1)
S.chao1(soilbac1)
S.chao2(1, soilbac.t)
S.ace(soilbac1)
soilbac.S <- S.obs(soilbac.t)
min.N <- min(rowSums(soilbac.t))
S.rarefy <- rarefy(x = soilbac.t, sample = min.N, se = TRUE)
rarecurve(x = soilbac.t, step = 20, col = "blue", cex = 0.6, las = 1)
abline(0, 1, col = 'red')
text(1500, 1500, "1:1", pos = 2, col = 'red')
S.chao1(BCI[1])
S.chao1(BCI[1, ])
S.chao2(1, BCI)
S.ace(BCI[1, ])
S.chao1(BCI[1, ])
S.chao2(1, BCI)
S.ace(BCI[1, ])
RACresults <- radfit(BCI[1, ])
print(RACresults)
plot.new()
plot(RACresults, las = 1, cex.lab = 1.4, cex.axis = 1.25)
RACresults <- radfit(BCI[1, ])
print(RACresults)
plot.new()
plot(RACresults, las = 1, cex.lab = 1.4, cex.axis = 1.25)
